# ZipMobile Platform
Обновлено: 2026-02-09 20:11 (GMT+4)

## Что это
SaaS-платформа для сервисных центров мобильных устройств.
Агрегация цен на запчасти + шлюз к Avito API + омниканальный мессенджер (будущее).

## Структура проекта

```
ZipMobile/
├── CONTRACTS/              API-контракты (OpenAPI YAML)
├── tenant-auth/            Микросервис: авторизация, биллинг, команда
├── parts-api/              Микросервис: каталог запчастей (будущее)
├── frontend-admin/         Фронтенд: админка тенанта (будущее)
├── frontend-miniapp/       Фронтенд: Telegram Mini App (Vue 3, Naive UI, Vite, TG WebApp SDK, порт 3001)
└── docker-compose.yml      Оркестрация всех сервисов
```

## Правила разработки

### Структура кода
- Каждый микросервис — отдельная папка верхнего уровня
- Точка сборки микросервиса: `src/main.py`
- Документация только через CLAUDE.md на соответствующем уровне

### Контракты API
- Все API-контракты лежат ТОЛЬКО в `/CONTRACTS/`
- Перед изменением формата API — СНАЧАЛА обновить контракт
- Фронтенд и бэкенд реализуют один и тот же контракт

### Метки времени
- Все файлы CLAUDE.md, PROGRESS.md и контракты маркируются датой/временем последнего изменения
- Формат: `Обновлено: 2026-02-09 22:30 (GMT+4)`
- Часовой пояс: GMT+4 (локальное время)
- Метка ставится в первой строке после заголовка файла
- При любом изменении файла — обновить метку

### Запрещено
- НЕ создавать папки верхнего уровня без явного согласования
- НЕ создавать файлы README.md, DOCS/, NOTES.md, ARCHITECTURE.md и т.п.
- Вся документация — через CLAUDE.md на соответствующем уровне
- НЕ дублировать модели данных между микросервисами
- НЕ менять формат ответа API без обновления контракта в /CONTRACTS/
- НЕ менять файлы за пределами текущей задачи без явного согласования

### Порядок работы
1. Прочитать CLAUDE.md текущего микросервиса
2. Если нужен контракт — прочитать файл из /CONTRACTS/
3. Назвать какие файлы будут изменены — дождаться подтверждения
4. После изменений — обновить CLAUDE.md (статус, файлы, метка времени)

## Стек

| Слой | Технологии |
|------|-----------|
| Backend | Python 3.11+, FastAPI, Pydantic v2 |
| БД | Supabase PostgreSQL (PostgREST API, собственный wrapper, НЕ supabase-py SDK) |
| Frontend | Vue 3, Pinia, Vite, TailwindCSS |
| Инфра | Docker Compose, Nginx, SSH reverse tunnel |

## Сервисы и порты

| Сервис | Порт | БД (Supabase project) |
|--------|------|-----------------------|
| tenant-auth | 8090 | dskhyumhxgbzmuefmrax |
| parts-api | 8000 | griexhozxrqtepcilfnu |
| frontend-admin | 3000 | — |
| frontend-miniapp | 3001 | — |

## Supabase — правила работы с БД
- Используем собственный PostgREST wrapper (`storage/supabase.py`), НЕ supabase-py SDK
- Ключ: service_role (обходит RLS)
- Фильтры: `.eq()`, `.neq()`, `.gt()`, `.gte()`, `.lt()`, `.lte()`
- Сортировка: `.order("field", desc=True)`
- Лимит: `.limit(N)`
